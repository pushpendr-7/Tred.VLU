{% extends 'auctions/base.html' %}
{% block title %}{{ item.title }}{% endblock %}
{% block content %}
<div class="row g-3">
  <div class="col-md-6">
    <img src="{{ item.image.url }}" alt="{{ item.title }}" class="img-fluid rounded">
  </div>
  <div class="col-md-6">
    <h1 class="h3">{{ item.title }}</h1>
    <p>{{ item.description }}</p>
    <p class="text-muted">Address: {{ item.address }}</p>
    <p>Starting price: <strong>{{ item.starting_price }}</strong></p>
    <p>Highest bid: <strong>{% if item.highest_bid %}{{ item.highest_bid.amount }}{% else %}-{% endif %}</strong></p>
    <p>Participants: {{ item.participants_count }}</p>
    <p>Ends at: {{ item.ends_at }}</p>

    {% if user.is_authenticated %}
      <form action="/items/{{ item.pk }}/bid/" method="post" class="row gy-2 gx-2 align-items-center">
        {% csrf_token %}
        <div class="col-auto">
          <input type="number" step="0.01" min="0" name="amount" class="form-control" placeholder="Your bid" required>
        </div>
        <div class="col-auto">
          <button class="btn btn-outline-primary">Place bid</button>
        </div>
      </form>

      {% if item.buy_now_price %}
      <div class="mt-3">
        <a href="/items/{{ item.pk }}/buy/" class="btn btn-success">Buy now for {{ item.buy_now_price }}</a>
      </div>
      {% endif %}
    {% else %}
      <div class="alert alert-warning">Please <a href="/login/">login</a> to bid or buy.</div>
    {% endif %}
  </div>
</div>

<hr>
<h2 class="h5">Bids</h2>
<ul class="list-group">
  {% for bid in bids %}
    <li class="list-group-item d-flex justify-content-between">
      <span>{{ bid.bidder.username }}</span>
      <span>{{ bid.amount }}</span>
      <span class="text-muted">{{ bid.created_at }}</span>
    </li>
  {% empty %}
    <li class="list-group-item">No bids yet.</li>
  {% endfor %}
</ul>
{% endblock %}
